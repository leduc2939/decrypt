<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Document</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"
          integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
            crossorigin="anonymous"></script>
    <link rel="stylesheet" type="text/css" href="style.css" />      

</head>
<body>

<div class="form"tabindex="1">
    <form action="/login" method = "post">
      <input type="text" placeholder="Name" class= "user_name_input" id="user_name_input" required="true" />
      <button class = "enter_button" id ='enter_button' tabindex="2">Enter</button>
    </form>
</div>
<div class="glow1" tabindex="3" id="teamThua">
  <span class="text"><a>Team Thua</a></span>
</div>
<div class="glow2" tabindex="4" id="teamLoser">
  <span class="text"><a>Team Loser</a></span>
</div>

<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct"
        crossorigin="anonymous"></script>
<script src="script.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script src="https://cdn.jsdelivr.net/npm/uuid@latest/dist/umd/uuidv4.min.js"></script>
<script>
  
  let my_user_id = "";
  var socket = io();
  let my_team = "";
  // check which team is chosen and alternate the team variable
  var teamThua = document.getElementById('teamThua');
  var teamLoser = document.getElementById('teamLoser');

  teamThua.addEventListener('click', function(e) {
      my_team  = '1';
      teamThua.classList.add("glow_active");
      teamLoser.classList.remove("glow_active");
      console.log('teamThua');
  });

  teamLoser.addEventListener('click', function(e) {
      my_team  = '2';
      teamLoser.classList.add("glow_active");
      teamThua.classList.remove("glow_active");
      console.log('teamLoser');
  });

  socket.on('connect', function() {
      console.log('connected');
      document.getElementById("teamThua").click();
      my_team = "1";
      if (sessionStorage.getItem('user_id')){
        my_user_id = sessionStorage.getItem('user_id');
        socket.emit('iden_user_id', my_user_id);
        console.log('user has user_id: ' + my_user_id);

      } else {
        my_user_id = uuidv4();
        sessionStorage.setItem('user_id',my_user_id);
        socket.emit('iden_user_id', my_user_id);
        console.log('issue user_id: ' + my_user_id);
      } 
  });

  socket.on('recognized', (user_id, user_info) =>{
      if (my_user_id == user_id) {
        console.log(user_info);
      }
  });


  var userName = document.getElementById('user_name_input');
  var enter_button = document.getElementById('enter_button');
  enter_button.addEventListener('click', function(e) {
      if (userName.value) {
        console.log(userName.value);
        sessionStorage.setItem('user_team', my_team);
        sessionStorage.setItem('user_name', userName.value)
        socket.emit('enterGame', my_user_id, userName.value, my_team);
      }
  });



    // socket.on('newGame_JS', () => {
    //     console.log('received newGame signal');
    //     newGame_JS();
    // });

    // button for sending giving-clues sinal: client that clicked the button is given
    // the html-change while others have the button greyed out
    // var giveClues = document.getElementById('giveClues');
    // giveClues.addEventListener('click', function(e) {
    //     socket.emit('giveClues',my_user_id);
    // });
  </script>


</body>
</html>